/*
 Highcharts JS v10.0.0 (2022-03-16)

 Sankey diagram module

 (c) 2010-2021 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(r){b(r);b.Highcharts=r;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function r(b,k,p,l){b.hasOwnProperty(k)||(b[k]=l.apply(null,p))}b=b?b._modules:{};r(b,"Series/NodesComposition.js",[b["Core/Series/Point.js"],b["Core/Series/Series.js"],b["Core/Utilities.js"]],function(b,k,p){var l=
p.defined,w=p.extend,y=p.find,g=p.merge,c=p.pick,m;(function(a){function e(){this.data=[].concat(this.points||[],this.nodes);return k.prototype.destroy.apply(this,arguments)}function m(){this.nodes&&(this.nodes.forEach(function(a){a.destroy()}),this.nodes.length=0);k.prototype.setData.apply(this,arguments)}function t(a){var c=arguments,d=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==a&&d.forEach(function(a){a&&a.series&&(b.prototype.setState.apply(a,c),a.isNode||
(a.fromNode.graphic&&b.prototype.setState.apply(a.fromNode,c),a.toNode&&a.toNode.graphic&&b.prototype.setState.apply(a.toNode,c)))});b.prototype.setState.apply(this,c)}function u(a,e,d,f){var h=this,n=this.series.options.nodes,x=this.series.options.data,m=x&&x.length||0,v=x&&x[this.index];b.prototype.update.call(this,a,this.isNode?!1:e,d,f);this.isNode&&(a=(n||[]).reduce(function(a,n,c){return h.id===n.id?c:a},-1),f=g(n&&n[a]||{},x&&x[this.index]||{}),x&&(v?x[this.index]=v:x.length=m),n?0<=a?n[a]=
f:n.push(f):this.series.options.nodes=[f],c(e,!0)&&this.series.chart.redraw(d))}var q=[];a.compose=function(a,c){-1===q.indexOf(a)&&(q.push(a),a=a.prototype,a.setNodeState=t,a.setState=t,a.update=u);-1===q.indexOf(c)&&(q.push(c),a=c.prototype,a.destroy=e,a.setData=m);return c};a.createNode=function(a){var e=this.pointClass,d=function(a,n){return y(a,function(a){return a.id===n})},f=d(this.nodes,a);f||(d=this.options.nodes&&d(this.options.nodes,a),f=(new e).init(this,w({className:"highcharts-node",
isNode:!0,id:a,y:1},d)),f.linksTo=[],f.linksFrom=[],f.getSum=function(){var a=0,n=0;f.linksTo.forEach(function(h){a+=h.weight});f.linksFrom.forEach(function(a){n+=a.weight});return Math.max(a,n)},f.offset=function(a,n){for(var h=0,c=0;c<f[n].length;c++){if(f[n][c]===a)return h;h+=f[n][c].weight}},f.hasShape=function(){var a=0;f.linksTo.forEach(function(h){h.outgoing&&a++});return!f.linksTo.length||a!==f.linksTo.length},f.index=this.nodes.push(f)-1);f.formatPrefix="node";f.name=f.name||f.options.id||
"";f.mass=c(f.options.mass,f.options.marker&&f.options.marker.radius,this.options.marker&&this.options.marker.radius,4);return f};a.destroy=e;a.generatePoints=function(){var a=this.chart,e={};k.prototype.generatePoints.call(this);this.nodes||(this.nodes=[]);this.colorCounter=0;this.nodes.forEach(function(a){a.linksFrom.length=0;a.linksTo.length=0;a.level=a.options.level});this.points.forEach(function(d){l(d.from)&&(e[d.from]||(e[d.from]=this.createNode(d.from)),e[d.from].linksFrom.push(d),d.fromNode=
e[d.from],a.styledMode?d.colorIndex=c(d.options.colorIndex,e[d.from].colorIndex):d.color=d.options.color||e[d.from].color);l(d.to)&&(e[d.to]||(e[d.to]=this.createNode(d.to)),e[d.to].linksTo.push(d),d.toNode=e[d.to]);d.name=d.name||d.id},this);this.nodeLookup=e};a.setNodeState=t;a.updateNode=u})(m||(m={}));return m});r(b,"Series/Sankey/SankeyPoint.js",[b["Core/Series/Point.js"],b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],function(b,k,p){var l=this&&this.__extends||function(){var b=function(g,
c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var e in a)a.hasOwnProperty(e)&&(c[e]=a[e])};return b(g,c)};return function(g,c){function m(){this.constructor=g}b(g,c);g.prototype=null===c?Object.create(c):(m.prototype=c.prototype,new m)}}(),w=p.defined;return function(k){function g(){var c=null!==k&&k.apply(this,arguments)||this;c.className=void 0;c.fromNode=void 0;c.level=void 0;c.linkBase=void 0;c.linksFrom=void 0;c.linksTo=void 0;c.mass=
void 0;c.nodeX=void 0;c.nodeY=void 0;c.options=void 0;c.series=void 0;c.toNode=void 0;return c}l(g,k);g.prototype.applyOptions=function(c,m){b.prototype.applyOptions.call(this,c,m);w(this.options.level)&&(this.options.column=this.column=this.options.level);return this};g.prototype.getClassName=function(){return(this.isNode?"highcharts-node ":"highcharts-link ")+b.prototype.getClassName.call(this)};g.prototype.getFromNode=function(){for(var c=-1,b,a=0;a<this.linksTo.length;a++){var e=this.linksTo[a];
e.fromNode.column>c&&e.fromNode!==this&&(b=e.fromNode,c=b.column)}return{fromNode:b,fromColumn:c}};g.prototype.setNodeColumn=function(){w(this.options.column)||(this.column=0===this.linksTo.length?0:this.getFromNode().fromColumn+1)};g.prototype.isValid=function(){return this.isNode||"number"===typeof this.weight};return g}(k.seriesTypes.column.prototype.pointClass)});r(b,"Series/Sankey/SankeyColumnComposition.js",[b["Core/Utilities.js"]],function(b){var k=b.defined,p=b.relativeLength,l;(function(b){b.compose=
function(b,c){b.sankeyColumn=new l(b,c);return b};var l=function(){function b(c,b){this.points=c;this.series=b}b.prototype.getTranslationFactor=function(c){for(var b=this.points,a=b.slice(),e=c.options.minLinkWidth||0,g=0,t,u=(c.chart.plotSizeY||0)-(c.options.borderWidth||0)-(b.length-1)*c.nodePadding;b.length;){g=u/b.sankeyColumn.sum();c=!1;for(t=b.length;t--;)b[t].getSum()*g<e&&(b.splice(t,1),u-=e,c=!0);if(!c)break}b.length=0;a.forEach(function(a){b.push(a)});return g};b.prototype.top=function(c){var b=
this.series,a=b.nodePadding,e=this.points.reduce(function(e,g){0<e&&(e+=a);g=Math.max(g.getSum()*c,b.options.minLinkWidth||0);return e+g},0);return((b.chart.plotSizeY||0)-e)/2};b.prototype.left=function(c){var b=this.series,a=b.chart,e=b.options.equalNodes,g=a.inverted?a.plotHeight:a.plotWidth,t=b.nodePadding,u=this.points.reduce(function(a,m){0<a&&(a+=t);m=e?g/m.series.nodes.length-t:Math.max(m.getSum()*c,b.options.minLinkWidth||0);return a+m},0);return((a.plotSizeX||0)-Math.round(u))/2};b.prototype.sum=
function(){return this.points.reduce(function(b,g){return b+g.getSum()},0)};b.prototype.offset=function(b,g){var a=this.points,c=this.series,m=c.nodePadding,t=0;if(c.is("organization")&&b.hangsFrom)return{absoluteTop:b.hangsFrom.nodeY};for(var u=0;u<a.length;u++){var q=a[u].getSum();var l=Math.max(q*g,c.options.minLinkWidth||0),v=b.options[c.chart.inverted?"offsetHorizontal":"offsetVertical"],d=b.options.offset||0;q=q?l+m:0;if(a[u]===b)return{relativeTop:t+(k(v)?p(v,l):p(d,q))};t+=q}};return b}();
b.SankeyColumnAdditions=l})(l||(l={}));return l});r(b,"Series/TreeUtilities.js",[b["Core/Color/Color.js"],b["Core/Utilities.js"]],function(b,k){function p(a,b){var c=b.before,e=b.idRoot,g=b.mapIdToNode[e],q=b.points[a.i],k=q&&q.options||{},v=[],d=0;a.levelDynamic=a.level-(!1!==b.levelIsConstant?0:g.level);a.name=m(q&&q.name,"");a.visible=e===a.id||!0===b.visible;"function"===typeof c&&(a=c(a,b));a.children.forEach(function(c,h){var n=l({},b);l(n,{index:h,siblings:a.children.length,visible:a.visible});
c=p(c,n);v.push(c);c.visible&&(d+=c.val)});c=m(k.value,d);a.visible=0<=c&&(0<d||a.visible);a.children=v;a.childrenTotal=d;a.isLeaf=a.visible&&!d;a.val=c;return a}var l=k.extend,w=k.isArray,r=k.isNumber,g=k.isObject,c=k.merge,m=k.pick;return{getColor:function(a,c){var e=c.index,g=c.mapOptionsToLevel,k=c.parentColor,q=c.parentColorIndex,l=c.series,v=c.colors,d=c.siblings,f=l.points,h=l.chart.options.chart,n;if(a){f=f[a.i];a=g[a.level]||{};if(g=f&&a.colorByPoint){var x=f.index%(v?v.length:h.colorCount);
var H=v&&v[x]}if(!l.chart.styledMode){v=f&&f.options.color;h=a&&a.color;if(n=k)n=(n=a&&a.colorVariation)&&"brightness"===n.key&&e&&d?b.parse(k).brighten(e/d*n.to).get():k;n=m(v,h,H,n,l.color)}var I=m(f&&f.options.colorIndex,a&&a.colorIndex,x,q,c.colorIndex)}return{color:n,colorIndex:I}},getLevelOptions:function(a){var b=null;if(g(a)){b={};var k=r(a.from)?a.from:1;var l=a.levels;var p={};var q=g(a.defaults)?a.defaults:{};w(l)&&(p=l.reduce(function(a,b){if(g(b)&&r(b.level)){var d=c({},b);var f=m(d.levelIsConstant,
q.levelIsConstant);delete d.levelIsConstant;delete d.level;b=b.level+(f?0:k-1);g(a[b])?c(!0,a[b],d):a[b]=d}return a},{}));l=r(a.to)?a.to:1;for(a=0;a<=l;a++)b[a]=c({},q,g(p[a])?p[a]:{})}return b},setTreeValues:p,updateRootId:function(a){if(g(a)){var b=g(a.options)?a.options:{};b=m(a.rootNode,b.rootId,"");g(a.userOptions)&&(a.userOptions.rootId=b);a.rootNode=b}return b}}});r(b,"Series/Sankey/SankeySeries.js",[b["Core/Color/Color.js"],b["Core/Globals.js"],b["Series/NodesComposition.js"],b["Series/Sankey/SankeyPoint.js"],
b["Core/Series/SeriesRegistry.js"],b["Series/Sankey/SankeyColumnComposition.js"],b["Series/TreeUtilities.js"],b["Core/Utilities.js"]],function(b,k,p,l,r,y,g,c){var m=this&&this.__extends||function(){var a=function(b,h){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var h in b)b.hasOwnProperty(h)&&(a[h]=b[h])};return a(b,h)};return function(b,h){function c(){this.constructor=b}a(b,h);b.prototype=null===h?Object.create(h):(c.prototype=h.prototype,
new c)}}(),a=r.series,e=r.seriesTypes.column,w=g.getLevelOptions;g=c.extend;var t=c.isObject,u=c.merge,q=c.pick,A=c.relativeLength,v=c.stableSort;c=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.colDistance=void 0;b.data=void 0;b.group=void 0;b.nodeLookup=void 0;b.nodePadding=void 0;b.nodes=void 0;b.nodeWidth=void 0;b.options=void 0;b.points=void 0;b.translationFactor=void 0;return b}m(c,a);c.getDLOptions=function(a){var b=t(a.optionsPoint)?a.optionsPoint.dataLabels:{};a=
t(a.level)?a.level.dataLabels:{};return u({style:{}},a,b)};c.prototype.createNodeColumns=function(){var a=[];this.nodes.forEach(function(b){b.setNodeColumn();a[b.column]||(a[b.column]=y.compose([],this));a[b.column].push(b)},this);for(var b=0;b<a.length;b++)"undefined"===typeof a[b]&&(a[b]=y.compose([],this));return a};c.prototype.generatePoints=function(){function a(b,c){"undefined"===typeof b.level&&(b.level=c,b.linksFrom.forEach(function(b){b.toNode&&a(b.toNode,c+1)}))}p.generatePoints.apply(this,
arguments);this.orderNodes&&(this.nodes.filter(function(a){return 0===a.linksTo.length}).forEach(function(b){a(b,0)}),v(this.nodes,function(a,b){return a.level-b.level}))};c.prototype.getNodePadding=function(){var a=this.options.nodePadding||0;if(this.nodeColumns){var b=this.nodeColumns.reduce(function(a,b){return Math.max(a,b.length)},0);b*a>this.chart.plotSizeY&&(a=this.chart.plotSizeY/b)}return a};c.prototype.hasData=function(){return!!this.processedXData.length};c.prototype.pointAttribs=function(a,
c){if(!a)return{};var h=this,n=h.mapOptionsToLevel[(a.isNode?a.level:a.fromNode.level)||0]||{},d=a.options,e=n.states&&n.states[c||""]||{};c=["colorByPoint","borderColor","borderWidth","linkOpacity"].reduce(function(a,b){a[b]=q(e[b],d[b],n[b],h.options[b]);return a},{});var g=q(e.color,d.color,c.colorByPoint?a.color:n.color);return a.isNode?{fill:g,stroke:c.borderColor,"stroke-width":c.borderWidth}:{fill:b.parse(g).setOpacity(c.linkOpacity).get()}};c.prototype.render=function(){var a=this.points;
this.points=this.points.concat(this.nodes||[]);e.prototype.render.call(this);this.points=a};c.prototype.translate=function(){this.processedXData||this.processData();this.generatePoints();this.nodeColumns=this.createNodeColumns();this.nodeWidth=A(this.options.nodeWidth,this.chart.plotSizeX);var a=this,b=this.chart,c=this.options,d=this.nodeWidth,e=this.nodeColumns;this.nodePadding=this.getNodePadding();this.translationFactor=e.reduce(function(b,c){return Math.min(b,c.sankeyColumn.getTranslationFactor(a))},
Infinity);this.colDistance=(b.plotSizeX-d-c.borderWidth)/Math.max(1,e.length-1);a.mapOptionsToLevel=w({from:1,levels:c.levels,to:e.length-1,defaults:{borderColor:c.borderColor,borderRadius:c.borderRadius,borderWidth:c.borderWidth,color:a.color,colorByPoint:c.colorByPoint,levelIsConstant:!0,linkColor:c.linkColor,linkLineWidth:c.linkLineWidth,linkOpacity:c.linkOpacity,states:c.states}});e.forEach(function(b){b.forEach(function(c){a.translateNode(c,b)})},this);this.nodes.forEach(function(b){b.linksFrom.forEach(function(b){(b.weight||
b.isNull)&&b.to&&(a.translateLink(b),b.allowShadow=!1)})})};c.prototype.translateLink=function(a){var b=function(b,c){c=b.offset(a,c)*g;return Math.min(b.nodeY+c,b.nodeY+(b.shapeArgs&&b.shapeArgs.height||0)-h)},c=a.fromNode,d=a.toNode,e=this.chart,g=this.translationFactor,h=Math.max(a.weight*g,this.options.minLinkWidth),f=(e.inverted?-this.colDistance:this.colDistance)*this.options.curveFactor,l=b(c,"linksFrom");b=b(d,"linksTo");var k=c.nodeX,m=this.nodeWidth;d=d.nodeX;var q=a.outgoing,p=d>k+m;e.inverted&&
(l=e.plotSizeY-l,b=(e.plotSizeY||0)-b,m=-m,h=-h,p=k>d);a.shapeType="path";a.linkBase=[l,l+h,b,b+h];if(p&&"number"===typeof b)a.shapeArgs={d:[["M",k+m,l],["C",k+m+f,l,d-f,b,d,b],["L",d+(q?m:0),b+h/2],["L",d,b+h],["C",d-f,b+h,k+m+f,l+h,k+m,l+h],["Z"]]};else if("number"===typeof b){f=d-20-h;q=d-20;p=k+m;var r=p+20,t=r+h,v=l,u=l+h,w=u+20,B=w+(e.plotHeight-l-h),z=B+20,y=z+h,D=b,C=D+h,A=C+20,E=z+.7*h,F=d-.7*h,G=p+.7*h;a.shapeArgs={d:[["M",p,v],["C",G,v,t,u-.7*h,t,w],["L",t,B],["C",t,E,G,y,p,y],["L",d,y],
["C",F,y,f,E,f,B],["L",f,A],["C",f,C-.7*h,F,D,d,D],["L",d,C],["C",q,C,q,C,q,A],["L",q,B],["C",q,z,q,z,d,z],["L",p,z],["C",r,z,r,z,r,B],["L",r,w],["C",r,u,r,u,p,u],["Z"]]}}a.dlBox={x:k+(d-k+m)/2,y:l+(b-l)/2,height:h,width:0};a.tooltipPos=e.inverted?[e.plotSizeY-a.dlBox.y-h/2,e.plotSizeX-a.dlBox.x]:[a.dlBox.x,a.dlBox.y+h/2];a.y=a.plotY=1;a.color||(a.color=c.color)};c.prototype.translateNode=function(a,b){var d=this.translationFactor,e=this.chart,g=this.options,f=a.getSum(),h=Math.max(Math.round(f*d),
this.options.minLinkWidth),l=Math.round(this.nodeWidth),k=Math.round(g.borderWidth)%2/2,m=b.sankeyColumn.offset(a,d);b=Math.floor(q(m.absoluteTop,b.sankeyColumn.top(d)+m.relativeTop))+k;k=Math.floor(this.colDistance*a.column+g.borderWidth/2)+A(a.options.offsetHorizontal||0,l)+k;k=e.inverted?e.plotSizeX-k:k;if(a.sum=f){a.shapeType="rect";a.nodeX=k;a.nodeY=b;f=k;d=b;m=a.options.width||g.width||l;var n=a.options.height||g.height||h;e.inverted&&(f=k-l,d=e.plotSizeY-b-h,m=a.options.height||g.height||l,
n=a.options.width||g.width||h);a.dlOptions=c.getDLOptions({level:this.mapOptionsToLevel[a.level],optionsPoint:a.options});a.plotX=1;a.plotY=1;a.tooltipPos=e.inverted?[e.plotSizeY-d-n/2,e.plotSizeX-f-m/2]:[f+m/2,d+n/2];a.shapeArgs={x:f,y:d,width:m,height:n,display:a.hasShape()?"":"none"}}else a.dlOptions={enabled:!1}};c.defaultOptions=u(e.defaultOptions,{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},
format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,minLinkWidth:0,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 10px">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}});return c}(e);p.compose(l,
c);g(c.prototype,{animate:a.prototype.animate,createNode:p.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:l,searchPoint:k.noop});r.registerSeriesType("sankey",c);"";"";return c});r(b,"masters/modules/sankey.src.js",[],function(){})});
//# sourceMappingURL=sankey.js.map